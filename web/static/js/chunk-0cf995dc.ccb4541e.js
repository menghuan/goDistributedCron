(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0cf995dc"],{"76fe":function(t,e,n){"use strict";var a=n("d81d"),r=n("83d6"),o=n.n(r);e["a"]={list:function(t,e){a["a"].post(o.a.serviceUrl+"/job/list",t,e)},save:function(t,e){a["a"].post(o.a.serviceUrl+"/job/save",t,e)},delete:function(t,e){a["a"].post(o.a.serviceUrl+"/job/delete",{name:t},e)},kill:function(t,e){a["a"].post(o.a.serviceUrl+"/job/kill",{name:t},e)},enable:function(t,e){a["a"].post(o.a.serviceUrl+"/job/enable",{name:t},e)},disable:function(t,e){a["a"].post(o.a.serviceUrl+"/job/disable",{name:t},e)},run:function(t,e){a["a"].post(o.a.serviceUrl+"/job/run",{name:t},e)},log:function(t,e){a["a"].get("/job/log",t,e)}}},d81d:function(t,e,n){"use strict";n("ac4d"),n("8a81"),n("ac6a");var a=n("bc3a"),r=n.n(a),o=n("5c96"),s=n("a18c"),i="加载失败, 请稍后再试",c=0,u=401,l=801;function f(t,e){t.then(function(t){return p(t,e)}).catch(function(t){return h(t)})}function d(t,e){switch(t){case l:return s["a"].push("/install"),!1;case u:return s["a"].push("/user/login"),!1}return t===c||(o["Message"].error({message:e}),!1)}function p(t,e){d(t.data.code,t.data.message)&&e&&e(t.data.data,t.data.code,t.data.message)}function h(t){o["Message"].error({message:"请求失败 - "+t})}r.a.defaults.baseURL="",r.a.defaults.timeout=1e4,r.a.defaults.responseType="json",r.a.interceptors.response.use(function(t){return t},function(t){return o["Message"].error({message:i}),Promise.reject(t)}),e["a"]={get:function(t,e,n){var a=r.a.get(t,{params:e});f(a,n)},batchGet:function(t,e){var n=[],a=!0,o=!1,s=void 0;try{for(var i,c=t[Symbol.iterator]();!(a=(i=c.next()).done);a=!0){var u=i.value,l={};void 0!==u.params&&(l=u.params),n.push(r.a.get(u.uri,{params:l}))}}catch(f){o=!0,s=f}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}r.a.all(n).then(r.a.spread(function(){for(var t=[],n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];for(var o=0,s=a;o<s.length;o++){var i=s[o];if(!d(i.data.code,i.data.message))return;t.push(i.data.data)}e.apply(void 0,t)})).catch(function(t){return h(t)})},post:function(t,e,n){var a=r.a.post(t,JSON.stringify(e),{headers:{post:{"Content-Type":"application/json"}}});f(a,n)}}},fe2f:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-row",{attrs:{type:"flex",justify:"end"}},[n("el-col",{attrs:{span:2}},[n("el-button",{attrs:{type:"info"},on:{click:t.refresh}},[t._v("刷新")])],1)],1),t._v(" "),n("br"),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.jobsLoading,expression:"jobsLoading"}],attrs:{data:t.jobs,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{align:"center",label:"ID",width:"95"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.$index)+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"任务名称",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.name)+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"shell命令",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.command))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"cron表达式",width:"240",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.cronExpr)+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{"class-name":"status-col",label:"任务操作",width:"430",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-row",[n("el-button",{attrs:{type:"primary"},on:{click:function(n){return t.editJob(e.row.name)}}},[t._v("编辑")]),t._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:function(n){return t.deleteJob(e.row.name)}}},[t._v("删除")])],1),t._v(" "),n("br"),t._v(" "),n("el-row",[n("el-button",{attrs:{type:"success"},on:{click:function(n){return t.runJob(e.row.name)}}},[t._v("手动执行")]),t._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:function(n){return t.killJob(e.row.name)}}},[t._v("强杀")]),t._v(" "),n("el-button",{attrs:{type:"info"},on:{click:function(n){return t.jumpToLog(e.row.name)}}},[t._v("查看日志")])],1)]}}])})],1)],1)},r=[],o=n("76fe"),s={data:function(){return{jobs:[],jobsTotal:0,isAdmin:this.$store.getters.user.isAdmin,searchParams:{page_size:200,page:1}}},created:function(){this.fetchData()},methods:{changeStatus:function(t){t.status?o["a"].enable(t.id):o["a"].disable(t.id)},changePage:function(t){this.searchParams.page=t,this.fetchData()},changePageSize:function(t){this.searchParams.page_size=t,this.fetchData()},fetchData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;o["a"].list(this.searchParams,function(n){t.jobs=n.data,e&&e()})},deleteJob:function(t){var e=this;this.$appConfirm(function(){o["a"].delete(t,function(){e.refresh()})})},killJob:function(t){var e=this;this.$appConfirm(function(){o["a"].kill(t,function(){e.refresh()})})},runJob:function(t){var e=this;this.$appConfirm(function(){o["a"].run(t,function(){e.$message.success("任务已开始执行")})},!0)},jumpToLog:function(t){this.$router.push("/job/log?name=".concat(t))},refresh:function(){var t=this;this.fetchData(function(){t.$message.success("刷新任务成功")})},editJob:function(t){var e="";e=null===t?"/job/add":"/job/add/".concat(t.id),this.$router.push(e)}}},i=s,c=n("2877"),u=Object(c["a"])(i,a,r,!1,null,null,null);e["default"]=u.exports}}]);